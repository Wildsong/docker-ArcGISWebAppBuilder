// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:builder/plugins/app-list/AppListPage.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"separate-line" \x3e\r\n    \x3cdiv class\x3d"switch-app-template"\x3e\r\n      \x3cdiv class \x3d"switch-btn-box selected jimu-float-leading" data-dojo-attach-point\x3d"appListBtnBox" \x3e\r\n        \x3cdiv class\x3d"switch-btn app-list-btn" data-dojo-attach-point\x3d"appListBtn" data-dojo-attach-event\x3d"onclick:_onSwitchToAppList"\x3e${nls.apps}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"blue-block"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class \x3d"switch-btn-box jimu-float-leading" data-dojo-attach-point\x3d"templateListBtnBox"\x3e\r\n        \x3cdiv class\x3d"switch-btn template-list-btn jimu-float-leading" data-dojo-attach-point\x3d"templateListBtn" data-dojo-attach-event\x3d"onclick:_onSwitchToTemplateList"\x3e${nls.templates}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"blue-block"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"app-content" data-dojo-attach-point\x3d"appContent"\x3e\r\n    \x3cdiv class\x3d"head-section" data-dojo-attach-point\x3d"head-section"\x3e\r\n        \x3cdiv class\x3d"textPart1 jimu-float-leading"\x3e${nls.welcomeMessage}\x3c/div\x3e\r\n        \x3cdiv class\x3d"textPart2 jimu-float-leading"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"importBtnDiv"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"create-button-div jimu-float-trailing" data-dojo-attach-point\x3d"createBtnDiv"\x3e\r\n          \x3cinput class\x3d"create-button jimu-ellipsis" type\x3d"button" title\x3d"${nls.appCreate}" value\x3d"${nls.appCreate}" data-dojo-attach-event\x3d"onclick:_onCreateClick"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"list-section" id\x3d"list-section" data-dojo-attach-point\x3d"listSection"\x3e\r\n      \x3ctable class\x3d"list-section-head"\x3e\r\n        \x3ctbody\x3e\r\n          \x3ctr class\x3d"head-content"\x3e\r\n            \x3cth class\x3d"name" data-dojo-attach-point\x3d"headContentName"\x3e${nls.appName}\x3c/th\x3e\r\n            \x3cth class\x3d"desc"\x3e${nls.appDesc}\x3c/th\x3e\r\n            \x3cth class\x3d"time"\x3e${nls.appTime}\x3c/th\x3e\r\n            \x3cth class\x3d"modified"\x3e${nls.appModified}\x3c/th\x3e\r\n            \x3cth class\x3d"creator"\x3e${nls.appCreator}\x3c/th\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n\r\n      \x3cdiv class\x3d"list-section-body-content" id\x3d"list-section-body-content" data-dojo-attach-point\x3d"listSectionBodyContent"\x3e\r\n        \x3ctable class\x3d"list-table" data-dojo-attach-point\x3d"listTable"\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"listTableBody"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n\r\n      \x3cdiv class\x3d"list-section-body-content" id\x3d"template-list-section-body-content" data-dojo-attach-point\x3d"templateListSectionBodyContent"\x3e\r\n        \x3ctable class\x3d"list-table" data-dojo-attach-point\x3d"templateListTable"\x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"templateListTableBody"\x3e\x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--iframe style\x3d"display:none" name\x3d"downloadTargetFrame"\x3e\x3c/iframe--\x3e\r\n\x3c/div\x3e\r\n\r\n'}});
define("dojo/_base/declare dojo/_base/html dojo/_base/array dojo/mouse dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./AppListPage.html dojo/on dojo/_base/lang ./AppOperMenu ./Import dojo/topic dojo/dom-class dojo/query jimu/dijit/Message jimu/utils dojox/form/Uploader dojo/NodeList-dom".split(" "),function(D,a,y,z,E,F,G,H,r,k,I,J,A,q,K,L,m){return D([E,F,G],{baseClass:"app-list-page",templateString:H,menu:void 0,label:"applist",apps:null,templates:null,sortBy:"lastUpdated",
_itemSelector:null,_importPopup:null,_eventHandles:null,_appOperMenus:null,_currentShownList:null,appListWidget:null,postMixInProperties:function(){this.inherited(arguments);this.nls=this.appListWidget.nls;this.loading=this.appListWidget.loading;this.folderUrl=this.appListWidget.folderUrl},constructor:function(){this._eventHandles=[];this._appOperMenus=[];this._currentShownList="appList"},startup:function(){this.inherited(arguments);a.setSelectable(this.appContent,!1);this.importDijit=(new J({appListWidget:this.appListWidget})).placeAt(this.importBtnDiv)},
refresh:function(b,c){this.createAppList(b,c)},createAppList:function(b,c){var e,d=null;this.cleanAppList();a.setStyle(this.listSectionBodyContent,"display","block");a.setStyle(this.templateListSectionBodyContent,"display","block");for(e=0;e<b.length;e++)d=this.createAppNode(b[e],e,d);for(e=0;e<c.length;e++)d=this.createAppNode(c[e],e,d,!0);"templateList"===this._currentShownList?(a.setStyle(this.templateListSectionBodyContent,"display","block"),a.setStyle(this.listSectionBodyContent,"display","none")):
(a.setStyle(this.templateListSectionBodyContent,"display","none"),a.setStyle(this.listSectionBodyContent,"display","block"))},cleanAppList:function(){a.empty(this.listTableBody);a.empty(this.templateListTableBody);y.forEach(this._appOperMenus,function(b){b.destroy()});this._appOperMenus=[];y.forEach(this._eventHandles,function(b){b.remove()});this._eventHandles=[]},createAppNode:function(b,c,e,d){if(d){var g=this.templateListTableBody;var l=this.templateListSectionBodyContent;var n=this.nls.preview}else g=
this.listTableBody,l=this.listSectionBodyContent,n=this.nls.launch;c=a.create("tr",{"class":"list-table-item"+(c%2?" list-table-item-add ":" "),"data-app-id":b.id,"data-app-name":b.name},g);var t=a.create("td",{"class":"item-begin-td item-first-td"},c);a.create("td",{"class":"item-begin-td item-second-td"},c);g=a.create("td",{"class":"item-name-td"},c);var p=a.create("div",{"class":"item-name",innerHTML:m.sanitizeHTML(b.name),title:b.name},g);var u=a.create("td",{"class":"item-desc-td"},c);var v=
a.create("div",{"class":"item-desc",innerHTML:m.sanitizeHTML(b.description),title:b.description},u);var h=a.create("td",{"class":"item-time-td"},c);var B=a.create("div",{"class":"item-time",innerHTML:m.sanitizeHTML(this.appListWidget._getLocaleDateTime(b.lastUpdated))},h);h=a.create("td",{"class":"item-modified-td"},c);var C=a.create("div",{"class":"item-modified",innerHTML:m.sanitizeHTML(b.modified)},h);h=a.create("td",{"class":"item-creator-td"},c);a.create("div",{"class":"item-creator",innerHTML:m.sanitizeHTML(b.creator)},
h);h=a.create("td",{"class":"item-loading-td",innerHTML:"\x3cdiv class\x3d'loading-div'\x3e\x3c/div\x3e"},c);var f=K(".loading-div",h)[0];a.create("img",{src:this.folderUrl+"css/images/download.gif","class":"loading-img"},f);h=a.create("td",{"class":"item-operations-td"},c);h=a.create("div",{"class":"item-operations-div"},h);a.setStyle(h,"display","none");var x=a.create("div",{"class":"item-more jimu-float-trailing"},h);var w="stemapp/index.html?id\x3d"+b.id;b.isPredefined&&(w+="\x26ispredefined\x3dtrue");
a.create("div",{innerHTML:'\x3ca href\x3d"'+m.sanitizeHTML(w)+'" target\x3d"_blank"\x3e'+m.sanitizeHTML(n)+"\x3c/a\x3e","class":"item-preview jimu-float-trailing",title:n},h);n="";b.isPredefined&&(n="display: none");n=a.create("div",{"class":"item-edit jimu-float-trailing",title:this.nls.edit,style:n},h);a.create("div",{innerHTML:this.nls.edit,"class":"item-edit-text jimu-float-leading"},n);w=a.create("td",{"class":"item-end-td"},c);w=a.create("div",{"class":"app-menu-div"},w);d=new I({app:b,posNode:c,
loadingDiv:f,appListWidget:this.appListWidget,nls:this.nls,isTemplate:d},w);this._appOperMenus.push(d);f=r(c,z.enter,k.hitch(this,this._onListTableItemMouseover,c,h,e));this._eventHandles.push(f);f=r(c,z.leave,k.hitch(this,this._onListTableItemMouseout,c,h,d,e));this._eventHandles.push(f);f=r(c,"click",k.hitch(this,function(M){M.stopPropagation()}));this._eventHandles.push(f);f=r(p,"dblclick",k.hitch(this,this._onNameDoubleClick,b,c,g,p,B,C));this._eventHandles.push(f);f=r(v,"dblclick",k.hitch(this,
this._onDescriptionDoubleClick,b,c,u,v,B,C));this._eventHandles.push(f);f=r(n,"click",k.hitch(this,this._onAppEditClick,b));this._eventHandles.push(f);f=r(x,"click",k.hitch(this,this._onAppMoreClick,b,d,x,t,c,h,e));this._eventHandles.push(f);f=r(this.ownerDocument,"click",k.hitch(this,this._onAppsClick,d,c,h,t,e,x));this._eventHandles.push(f);f=A.subscribe("menuAll/hide",k.hitch(this,this._onAppsClick,d,c,h,t,e,x));this._eventHandles.push(f);f=r(l,"scroll",k.hitch(this,this._onScroll,d,c,h,t,e,x));
this._eventHandles.push(f);return c},changeTextFieldOfNode:function(b,c,e,d,g,l,n){if(!b.isPredefined){var t=k.clone(b);a.setStyle(g,"display","none");var p="name"===d?a.create("input",{value:b[d],"class":"jimu-input item-input-"+d},e):a.create("textarea",{value:b[d],"class":"jimu-input item-textarea-"+d},e);p.focus();p.select();q.add(c,"list-table-item-dbclick");r(p,"blur",k.hitch(this,function(){b[d]!==p.value&&(p.value=m.stripHTML(p.value),t[d]=p.value,this.appListWidget.updateApp(t).then(k.hitch(this,
function(u,v){!0===v.success?(a.setAttr(g,"innerHTML",m.sanitizeHTML(u)),a.setAttr(g,"title",u),a.setAttr(l,"innerHTML",m.sanitizeHTML(this._getLocaleDateTime(v.lastUpdated))),a.setAttr(n,"innerHTML",m.sanitizeHTML(v.modified)),b[d]=u):(console.error("The response of updateApp is 'unsuccess'!"),new L({message:v.message}))},p.value),function(u){console.error("Updates 'app name' or 'app description' failed!"+u)}));a.destroy(p);a.setStyle(g,"display","block");q.remove(c,"list-table-item-dbclick")}))}},
_onCreateClick:function(){var b=this.appListWidget.pluginManager.getExtensions("startup.creation-entry")[0];b=this.appListWidget.pluginsMeta[b.pluginName];this.loading.show("");this.appListWidget.pluginManager.loadPlugin(b).then(k.hitch(this,function(c){c.popupDlg();this.loading.hide()}),k.hitch(this,function(){this.loading.hide()}))},_onSwitchToAppList:function(){a.setStyle(this.templateListSectionBodyContent,"display","none");a.setStyle(this.listSectionBodyContent,"display","block");a.setStyle(this.createBtnDiv,
"display","block");a.setAttr(this.headContentName,"innerHTML",m.sanitizeHTML(this.nls.appName));a.setStyle(this.importDijit.itemImportBtn,"display","block");a.addClass(this.appListBtnBox,"selected");a.removeClass(this.templateListBtnBox,"selected");this._currentShownList="appList"},_onSwitchToTemplateList:function(){a.setStyle(this.listSectionBodyContent,"display","none");a.setStyle(this.templateListSectionBodyContent,"display","block");a.setStyle(this.createBtnDiv,"display","none");a.setAttr(this.headContentName,
"innerHTML",m.sanitizeHTML(this.nls.templateName));a.setStyle(this.importDijit.itemImportBtn,"display","none");a.addClass(this.templateListBtnBox,"selected");a.removeClass(this.appListBtnBox,"selected");this._currentShownList="templateList"},_onListTableItemMouseover:function(b,c,e){q.add(b,"list-table-item-mouseover");e&&q.add(e,"list-table-next-item-mouseover");a.setStyle(c,"display","block")},_onListTableItemMouseout:function(b,c,e,d){e.isShow||(q.remove(b,"list-table-item-mouseover"),d&&q.remove(d,
"list-table-next-item-mouseover"),a.setStyle(c,"display","none"))},_onNameDoubleClick:function(b,c,e,d,g,l){k.hitch(this,this.changeTextFieldOfNode(b,c,e,"name",d,g,l))},_onDescriptionDoubleClick:function(b,c,e,d,g,l){k.hitch(this,this.changeTextFieldOfNode(b,c,e,"description",d,g,l))},_onAppEditClick:function(b){this.appListWidget.pluginManager.getPluginByName("startup").switchToAppConfig(b)},_onAppMoreClick:function(b,c,e,d,g,l,n,t){c.isShow?(c.hide(),q.remove(d,"item-first-td-selected"),a.removeClass(e,
"item-more-selected")):(A.publish("menuAll/hide"),c.set("app",b),c.show(),q.add(d,"item-first-td-selected"),a.addClass(e,"item-more-selected"),this._onListTableItemMouseover(g,l,n,t));t.stopPropagation()},_onAppsClick:function(b,c,e,d,g,l){b.hide();q.remove(d,"item-first-td-selected");g&&q.remove(g,"list-table-next-item-mouseover");q.remove(c,"list-table-item-mouseover");a.removeClass(l,"item-more-selected");a.setStyle(e,"display","none")},_onScroll:function(b,c,e,d,g,l){!0===b.isShow&&this._onAppsClick(b,
c,e,d,g,l)}})});